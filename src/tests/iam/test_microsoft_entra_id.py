import pytest

from sirius.iam.microsoft_entra_id import MicrosoftIdentity


# @pytest.mark.skip(reason="Requires Interaction")
@pytest.mark.asyncio
async def test_validate_jwt_token() -> None:
    microsoft_identity: MicrosoftIdentity = await MicrosoftIdentity.get_identity_from_access_token("eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiIyZmE2NzRlMy02ODE0LTRmYmYtODlhMi03YzhmZTg2NTYxMWIiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9hODk3ZDk3YS04YzM0LTQ3MWQtYTJjOC0xM2RjZDJjM2IzMjIvIiwiaWF0IjoxNjkxOTI0NDUxLCJuYmYiOjE2OTE5MjQ0NTEsImV4cCI6MTY5MTkyODkxMCwiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhVQUFBQWUvQjUrZVUzcnRlUVNUOGdWdWVWTDhEamM0M05aMGFLMVI2aXdKQXEwcFJNMGJSYzhPMmZPTXdBZ0tpQnRzNEZSZ25KdGJqSzJOYjVEbk0xVURIRG5wbVNmVm13ZlB5K0xBVnZnODNLODFvPSIsImFtciI6WyJwd2QiLCJyc2EiLCJtZmEiXSwiYXBwaWQiOiIyZmE2NzRlMy02ODE0LTRmYmYtODlhMi03YzhmZTg2NTYxMWIiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6IkF0aGF1ZGhhIiwiZ2l2ZW5fbmFtZSI6IkthdmluZHUiLCJpcGFkZHIiOiIyMC4xNjcuOTcuMTc0IiwibmFtZSI6IkthdmluZHUgQXRoYXVkaGEiLCJvaWQiOiJlZTMyYTAxZi03YmVkLTQ2YTctYTY3OC0xZjI0NWM4N2NiOTYiLCJyaCI6IjAuQVRrQWV0bVhxRFNNSFVlaXlCUGMwc096SXVOMHBpOFVhTDlQaWFKOGotaGxZUnM1QU5FLiIsInNjcCI6IkRpcmVjdG9yeS5SZWFkV3JpdGUuQWxsIFVzZXIuUmVhZCIsInN1YiI6IjBGU2lSbnZMUEZNRDJEbkx1em41SlF1YUJ2bXNxRjFkYnlrYjBQRDNwenciLCJ0aWQiOiJhODk3ZDk3YS04YzM0LTQ3MWQtYTJjOC0xM2RjZDJjM2IzMjIiLCJ1bmlxdWVfbmFtZSI6ImthdmluZHVAa2loLmNvbS5zZyIsInVwbiI6ImthdmluZHVAa2loLmNvbS5zZyIsInV0aSI6InJQbFg1VnpidWtLM29MeGh3SHRMQUEiLCJ2ZXIiOiIxLjAifQ.CYwfbcKp4nlolYGnUA9J2vjKMjpCPxi4x1ZZ_CDiE3kwVQUzWyZTc7kKiDuLFXZ89I2dKu0lVMWxYLRJoFaGv6Cm9TZn0XgmZiCmZCetnEjj5_hNfv5Oti2-_CUcwl1CDHIkcx3yLFAq7Emx0Mdwjda4YVN4Al8kmv4MrJaGNerGGQeFBMLKUC4sifgSn6dkMupgtI4aPJVU588vnCZ6hcE9osP7mqriuO3HPIDXnX0L5te5tRdj1QQepiN4SoH4P9QosI0NNo8I3C4d2lfHEBkwqZeWyzuK-4N9XbGYjxdSxtvDOUQkJh9-VyzaMG9TTQxjmeCK80L_S8tY2s-ZqA")
    assert microsoft_identity.name is not None
